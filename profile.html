<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>My Profile • Career & Skills Marketplace</title>
  <link rel="preconnect" href="https://fonts.googleapis.com">
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
  <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700;800&display=swap" rel="stylesheet">
  <link rel="stylesheet" href="styles.css" />
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.1/css/all.min.css" crossorigin="anonymous" referrerpolicy="no-referrer" />
</head>
<body>
  <header class="navbar">
    <div class="container nav-inner">
      <div class="brand">
        <a href="index.html"><img src="assets/logo.svg" alt="Logo" class="logo"/></a>
        <span>Career & Skills Marketplace</span>
      </div>
      <nav class="nav-links">
        <a href="index.html">Home</a>
        <a href="students.html">Students</a>
        <a href="employers.html">Employers</a>
        <a href="universities.html">Universities</a>
        <a href="mentors.html">Mentors</a>
        <a href="profile.html" class="btn btn-sm btn-primary">My Profile</a>
      </nav>
      <button class="nav-toggle" id="navToggle" aria-label="Toggle navigation">☰</button>
    </div>
  </header>

  <main>
    <section class="section">
      <div class="container">
        <div id="profileContainer"></div>
      </div>
    </section>
  </main>

  <footer class="site-footer">
    <div class="container footer-grid">
      <div>
        <div class="brand"><img src="assets/logo.svg" class="logo" alt=""/> <strong>Career & Skills</strong></div>
        <p class="muted">Your career profile and achievements.</p>
        <div class="social">
          <a href="#" aria-label="Twitter"><i class="fa-brands fa-x-twitter"></i></a>
          <a href="#" aria-label="LinkedIn"><i class="fa-brands fa-linkedin"></i></a>
          <a href="#" aria-label="GitHub"><i class="fa-brands fa-github"></i></a>
        </div>
      </div>
      <div>
        <h4>Explore</h4>
        <a href="students.html">Students</a>
        <a href="employers.html">Employers</a>
        <a href="mentors.html">Mentors</a>
        <a href="universities.html">Universities</a>
      </div>
      <div>
        <h4>Resources</h4>
        <a href="marketplace.html">Internship Marketplace</a>
        <a href="#">Guides</a>
        <a href="#">Support</a>
      </div>
      <div>
        <h4>Account</h4>
        <a href="profile.html">My Profile</a>
        <a href="signup.html">Sign Up</a>
        <a href="admin.html">Admin Dashboard</a>
      </div>
    </div>
    <div class="footer-bottom">
      <div class="container">© <span id="year"></span> Career & Skills Marketplace</div>
    </div>
  </footer>

  <script src="app.js"></script>
  <script>
    // Display profile based on logged in user
    const profileContainer = $('#profileContainer')
    
    if(!db.auth){
      profileContainer.innerHTML = `
        <div class="card" style="text-align:center; padding:3rem">
          <i class="fa-solid fa-user-slash fa-4x" style="color:var(--muted); margin-bottom:1rem"></i>
          <h2>No Profile Found</h2>
          <p class="muted">Please sign in to view your profile.</p>
          <a href="signup.html" class="btn btn-primary mt"><i class="fa-solid fa-user-plus"></i> Create Account</a>
        </div>
      `
    } else {
      const role = db.auth.role
      const email = db.auth.email
      
      if(role === 'Student'){
        const student = db.students.find(s=>s.email===email)
        if(student){
          profileContainer.innerHTML = `
            <div class="profile-header">
              <div class="profile-avatar">${student.name.split(' ').map(n=>n[0]).join('').slice(0,2).toUpperCase()}</div>
              <div>
                <h1>${student.name}</h1>
                <p class="muted"><i class="fa-solid fa-envelope"></i> ${student.email}</p>
                <p class="muted"><i class="fa-solid fa-graduation-cap"></i> ${student.dept || 'No department'}</p>
              </div>
            </div>

            <div class="grid-2 mt">
              <div class="card">
                <h3><i class="fa-solid fa-lightbulb"></i> Skills</h3>
                <div class="tags mt">${(student.skills||[]).map(s=>`<span class="badge">${s}</span>`).join('') || '<p class="muted">No skills added yet</p>'}</div>
              </div>

              <div class="card">
                <h3><i class="fa-solid fa-certificate"></i> Verified Skills</h3>
                <div class="tags mt">${(student.verified||[]).map(s=>`<span class="badge verify">${s}</span>`).join('') || '<p class="muted">No verified skills yet</p>'}</div>
              </div>
            </div>

            <div class="card mt">
              <h3><i class="fa-solid fa-briefcase"></i> Portfolio</h3>
              ${(student.portfolio||[]).length > 0 
                ? student.portfolio.map(url=>`<a href="${url}" target="_blank" class="btn btn-outline mt"><i class="fa-solid fa-link"></i> ${url}</a>`).join('') 
                : '<p class="muted">No portfolio links added yet</p>'}
            </div>

            <div class="inline mt">
              <a href="students.html" class="btn btn-primary"><i class="fa-solid fa-edit"></i> Edit Profile</a>
              <a href="marketplace.html" class="btn btn-outline"><i class="fa-solid fa-briefcase"></i> Find Internships</a>
              <button onclick="logout()" class="btn"><i class="fa-solid fa-right-from-bracket"></i> Logout</button>
            </div>
          `
        } else {
          profileContainer.innerHTML = `
            <div class="card" style="text-align:center; padding:3rem">
              <h2>Profile Not Complete</h2>
              <p class="muted">Please complete your student profile.</p>
              <a href="students.html" class="btn btn-primary mt"><i class="fa-solid fa-user-edit"></i> Complete Profile</a>
            </div>
          `
        }
      } else if(role === 'Mentor'){
        const mentor = db.mentors.find(m=>m.email===email)
        if(mentor){
          profileContainer.innerHTML = `
            <div class="profile-header">
              <div class="profile-avatar">${mentor.name.split(' ').map(n=>n[0]).join('').slice(0,2).toUpperCase()}</div>
              <div>
                <h1>${mentor.name}</h1>
                <p class="muted"><i class="fa-solid fa-envelope"></i> ${mentor.email}</p>
                <p class="muted"><i class="fa-solid fa-building"></i> ${mentor.company}</p>
              </div>
            </div>

            <div class="card mt">
              <h3><i class="fa-solid fa-star"></i> Expertise</h3>
              <div class="tags mt">${(mentor.skills||[]).map(s=>`<span class="badge">${s}</span>`).join('')}</div>
            </div>

            <div class="inline mt">
              <a href="mentors.html" class="btn btn-primary"><i class="fa-solid fa-users"></i> View Mentors</a>
              <button onclick="logout()" class="btn"><i class="fa-solid fa-right-from-bracket"></i> Logout</button>
            </div>
          `
        }
      } else {
        profileContainer.innerHTML = `
          <div class="profile-header">
            <div class="profile-avatar">${email[0].toUpperCase()}</div>
            <div>
              <h1>${role} Account</h1>
              <p class="muted"><i class="fa-solid fa-envelope"></i> ${email}</p>
            </div>
          </div>
          <div class="inline mt">
            <a href="admin.html" class="btn btn-primary"><i class="fa-solid fa-gauge"></i> Admin Dashboard</a>
            <button onclick="logout()" class="btn"><i class="fa-solid fa-right-from-bracket"></i> Logout</button>
          </div>
        `
      }
    }

    function logout(){
      if(confirm('Are you sure you want to logout?')){
        db.auth = null
        store.save(db)
        window.location.href = 'index.html'
      }
    }
  </script>
</body>
</html>
